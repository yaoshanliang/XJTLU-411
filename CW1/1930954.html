<!DOCTYPE html>
<html lang="en-us">

<head>
    <title>Music Festival</title>
    <meta charset="utf-8" />
    <meta name="description" content="Different kind of fruits." />
    <link rel="shortcut icon" href="./images/favicon.ico" />
    <script src="./js/data.js"></script>
    <script src="./js/function.js"></script>
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/iconfont.css" />
</head>

<body>

    <!-- header section -->
    <section class="banner" role="banner" id="banner">
        <header id="header" class="">
            <div class="header-content clearfix">
                <span class="logo">
                    <a href="1930954.html">XJTLU Music Festival</a>
                </span>
                <nav class="navigation open" role="navigation">
                    <ul class="primary-nav">
                        <li><a href="#banner" class="active">Home</a></li>
                        <li><a href="#playlist" class="">Playlist</a></li>
                        <li><a href="#services" class="">Information</a></li>
                        <li><a href="#Playlist" class="">Gallery</a></li>
                        <li><a href="#package" class="">APP</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- banner text -->
        <div class="container">
            <div class="col-md-10">
                <div class="banner-text text-center">
                    <h1>Music Festival</h1>
                    <p>Enjoy the live event</p>
                    <div><strong>18:00, 1 May 2020, XJTLU.</strong></div>
                    <div class="countdown">
                        <div class="countdown-container days"><span class="countdown-value days-bottom"
                                id="days-number">--</span><span class="countdown-heading days-top">Days</span></div>
                        <div class="countdown-container hours"><span class="countdown-value hours-bottom"
                                id="hours-number">--</span><span class="countdown-heading hours-top">Hours</span></div>
                        <div class="countdown-container minutes"><span class="countdown-value minutes-bottom"
                                id="minutes-number">--</span><span class="countdown-heading minutes-top">Minutes</span>
                        </div>
                        <div class="countdown-container seconds"><span class="countdown-value seconds-bottom"
                                id="seconds-number">--</span><span class="countdown-heading seconds-top">Seconds</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- banner text -->
    </section>
    <!-- header section -->

    <section id="playlist" class="playlistList">
        <div class="container">
            <div class="section-header">
                <h2>Playlist</h2>
                <p>Song list at the festival</p>
            </div>

            <div class="row">
                <div id="jp_container_2" class="jp-audio" role="application" aria-label="media player">
                    <div class="jp-type-playlist">
                        <div class="jp-gui jp-interface">
                            <div class="music-player">
                                <!-- audio标签 -->
                                <audio class="music-player__audio" id="audio-item" src=""></audio>
                                <!-- 播放器主体 -->
                                <div class="music-player__main">
                                    <!-- 模糊背景 -->
                                    <div class="music-player__blur" id="song-background"></div>
                                    <!-- 唱片 -->
                                    <div class="music-player__disc">
                                        <!-- 唱片图片 -->
                                        <div class="music-player__image">
                                            <img width="100%" id="song-icon" src="" alt="">
                                        </div>
                                    </div>
                                    <!-- 控件主体 -->
                                    <div class="music-player__controls">
                                        <!-- 歌曲信息 -->
                                        <div class="music__info">
                                            <h3 class="music__info--title" id="song-name"></h3>
                                            <p class="music__info--singer" id="song-singer"></p>
                                        </div>
                                        <!-- 控件... -->
                                        <div class="player-control">
                                            <div class="player-control__content">
                                                <div class="player-control__btns">
                                                    <div class="player-control__btn player-control__btn--next"
                                                        id="previous" onclick="previous();">
                                                        <img src="./images/music_previous.png"></div>
                                                    <div class="player-control__btn player-control__btn--play" id="play"
                                                        onclick="play();">
                                                        <img src="./images/music_play.png"></div>
                                                    <div class="player-control__btn player-control__btn--play" id="stop"
                                                        style="display: none;" onclick="pauseplay();">
                                                        <img src="./images/music_stop.png"></div>
                                                    <div class="player-control__btn player-control__btn--next" id="next"
                                                        onclick="next();">
                                                        <img src="./images/music_next.png"></div>
                                                </div>
                                                <div class="player-control__volume">
                                                    <div class="control__volume--icon player-control__btn" id="sound"
                                                        onclick="minus();">
                                                        <img src="./images/sound.png"></div>
                                                    <div class="control__volume--icon player-control__btn" id="minus"
                                                        style="display: none;" onclick="sound();">
                                                        <img src="./images/sound_minus.png"></div>
                                                    <div class="control__volume--progress progress">
                                                        <div class="back" style="width: 73px;"></div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 歌曲播放进度 -->
                                            <div class="player-control__content">
                                                <div class="player__song--progress progress">
                                                    <div class="back" id="bar"></div>
                                                    <!-- <div class="pointer" id="bar" style="left: 282.691px;"></div> -->
                                                </div>
                                                <div class="player__song--timeProgess nowTime" id="nowTime">0:00</div>
                                                <div class="player__song--timeProgess totalTime" id="totalTime">0:00
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="jp-playlist" id="songlist">

                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

</body>

<script>

    // Calculate the left time
    setInterval("countdown()", 1000);

    // Define the current song id
    let currentSong = 0;

    // Define the length of current song
    let duration = 0;

    // Play, pause, volume up and volume down
    let audiop = document.getElementById("audio-item");
    function play() {
        audiop.play();
        document.getElementsByClassName("music-player__image")[0].classList.add("play");
        document.getElementById("play").style.display = 'none';
        document.getElementById("stop").style.display = 'block';

        for (let i = 0; i < songs.length; i++) {
            document.getElementsByClassName("songItem")[i].classList.remove("currentSong");

            if (i == currentSong) {
                document.getElementById("song-name").innerText = songs[i].name;
                document.getElementById("song-singer").innerText = songs[i].singer;
                document.getElementById("song-icon").setAttribute("src", './audio/' + songs[i].image);
                document.getElementById("song-background").setAttribute("backgroundImage", './audio/' + songs[i].image);
                document.getElementsByClassName("songItem")[i].classList.add("currentSong");

            }
        }

    }
    function pauseplay() {
        audiop.pause();
        document.getElementsByClassName("music-player__image")[0].classList.remove("play");
        document.getElementById("play").style.display = 'block';
        document.getElementById("stop").style.display = 'none';
    }

    let lastVolume = 0;
    function minus() {
        lastVolume = audiop.volume;
        audiop.volume = 0;
        document.getElementById("sound").style.display = 'none';
        document.getElementById("minus").style.display = 'block';

    }
    function sound() {
        audiop.volume = lastVolume;
        document.getElementById("sound").style.display = 'block';
        document.getElementById("minus").style.display = 'none';
    }
    function volumeUp() {
        console.log(audiop.volume)
        if (audiop.volume < 1) {
            audiop.volume = audiop.volume + 0.1;
        }
    }
    function volumeDown() {
        console.log(audiop.volume)
        if (audiop.volume > 0) {
            audiop.volume = audiop.volume - 0.1;
        }
    }

    // Next song function
    function next() {
        currentSong++;
        if (currentSong > songs.length - 1) {
            currentSong = 0;
        }
        audiop.setAttribute('src', './audio/' + songs[currentSong].path)
        play();
    }

    // Previous song function
    function previous() {
        currentSong--;
        if (currentSong < 0) {
            currentSong = songs.length - 1;
        }
        audiop.setAttribute('src', './audio/' + songs[currentSong].path)
        play();
    }

    // Calculate the process of this song
    audiop.load();
    audiop.oncanplay = function () {
        duration = audiop.duration
    }

    audiop.addEventListener('timeupdate', updatePlayBar, false);
    function updatePlayBar() {
        let minutes = (audiop.currentTime / 60).toFixed(0);
        let seconds = (audiop.currentTime % 60).toFixed(0);
        if (seconds < 10) {
            seconds = '0' + seconds;
        }
        document.getElementById("nowTime").innerText = minutes + ':' + seconds;

        if (!isNaN(audiop.duration)) {
            minutes = (audiop.duration / 60).toFixed(0);
            seconds = (audiop.duration % 60).toFixed(0);
            if (seconds < 10) {
                seconds = '0' + seconds;
            }
            document.getElementById("totalTime").innerText = minutes + ':' + seconds;
        }


        // document.getElementById("nowTime").innerText = audiop.currentTime.toFixed(0);
        document.getElementById("bar").style.width = parseFloat(((audiop.currentTime / audiop.duration) * 100), 10) + "%";
    }

    let html = '';
    for (let i = 0; i < songs.length; i++) {
        html += '<div class="songItem" id="song-item-' + i + '"  onclick="playSong(' + i + ')">' +
            '<img class="songImage" src="./audio/' + songs[i].image + '">' +
            '<div class="songName">' + songs[i].name + '</div>' +
            '<div class="songSinger">' + songs[i].singer + '</div>' +
            '</div>';
    }

    document.getElementById("songlist").innerHTML = html;

    function playSong(id) {
        console.log(id);
        currentSong = id;
        audiop.setAttribute('src', './audio/' + songs[currentSong].path);
        play();
    }

    // Init the first song
    audiop.setAttribute('src', './audio/' + songs[0].path);
    document.getElementById("song-name").innerText = songs[0].name;
    document.getElementById("song-singer").innerText = songs[0].singer;
    document.getElementById("song-icon").setAttribute("src", './audio/' + songs[0].image);
    document.getElementById("song-background").setAttribute("background-image", "url(" + './audio/' + songs[0].image + ")");
    document.getElementsByClassName("songItem")[0].classList.add("currentSong");
</script>

</html>